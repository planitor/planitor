{"version":3,"file":"index-6d8f829d.js","sources":["../src/api.js","../src/forms/login.jsx","../src/forms/password-recovery.jsx","../src/accounts.jsx","../src/modals.js","../src/symbols.jsx","../src/navigation.jsx","../src/subscriptions.jsx","../src/follow.jsx","../src/forms/new-password.jsx","../src/maps.jsx","../src/app.jsx"],"sourcesContent":["import axios from \"axios\";\n\nfunction authHeaders() {\n  const token = localStorage.getItem(\"token\");\n  return {\n    headers: {\n      Authorization: `Bearer ${token}`,\n    },\n  };\n}\n\nexport const api = {\n  logInGetToken(email, password) {\n    const params = new URLSearchParams();\n    // Using FastAPI OAuth2PasswordRequestForm which requires `username` not email\n    params.append(\"username\", email);\n    params.append(\"password\", password);\n    return axios.post(`/notendur/login/access-token`, params);\n  },\n  getMe() {\n    return axios.get(`/notendur/me`, authHeaders());\n  },\n  passwordRecovery(email) {\n    return axios.post(`/notendur/password-recovery/${email}`);\n  },\n  resetPassword(password, token) {\n    return axios.post(`/notendur/reset-password`, {\n      new_password: password,\n      token,\n    });\n  },\n  logout() {\n    return axios.get(\"/notendur/logout\");\n  },\n  followCase(id) {\n    return axios.post(`/subscriptions/cases/${id}`, null, authHeaders());\n  },\n  unfollowCase(id) {\n    return axios.delete(`/subscriptions/cases/${id}`, authHeaders());\n  },\n  followAddress(hnitnum) {\n    return axios.post(\n      `/subscriptions/addresses/${hnitnum}`,\n      null,\n      authHeaders()\n    );\n  },\n  unfollowAddress(hnitnum) {\n    return axios.delete(`/subscriptions/addresses/${hnitnum}`, authHeaders());\n  },\n  getEntityAddresses(kennitala) {\n    return axios.get(`/entities/${kennitala}/addresses`);\n  },\n  getSubscriptions() {\n    return axios.get(\"/me/subscriptions\", authHeaders());\n  },\n  updateSubscription(id, active, immediate) {\n    return axios.post(\n      `/me/subscriptions/${id}`,\n      { active: active, immediate: immediate },\n      authHeaders()\n    );\n  },\n  deleteSubscription(id) {\n    return axios.delete(`/me/subscriptions/${id}`, authHeaders());\n  },\n};\n","import { h } from \"preact\";\nimport { useState } from \"preact/hooks\";\nimport { api } from \"../api\";\n\nconst classNames = (classArr) => classArr.filter((el) => el).join(\" \"); // filter falsy values\n\nexport const LoginForm = (props) => {\n  const { onSuccess, setScreen } = props;\n  const [username, setUsername] = useState({\n    value: \"\",\n    isDirty: false,\n    errors: [],\n  });\n  const [password, setPassword] = useState({\n    value: \"\",\n    isDirty: false,\n    errors: [],\n  });\n  const [form, setForm] = useState({ isLoading: false, error: null });\n\n  const onSubmit = (event) => {\n    event.preventDefault();\n    setForm({ isLoading: true, error: null });\n    api\n      .logInGetToken(username.value, password.value)\n      .then((response) => {\n        localStorage.setItem(\"token\", response.data.access_token);\n        onSuccess();\n      })\n      .catch(function (error) {\n        // handle error\n\n        // remove dirty from fields, meant for highlighting invalid fields until user edits\n        [setUsername, setPassword].forEach((setState) => {\n          setState((prevState) => ({\n            ...prevState,\n            errors: [],\n            isDirty: false,\n          }));\n        });\n\n        const errors = error.response.data.detail;\n\n        let formError = null;\n\n        if (typeof errors == \"string\") {\n          formError = errors;\n        }\n\n        if (Array.isArray(errors)) {\n          errors.forEach((error) => {\n            const { loc, msg, type } = error;\n            // The API has types of errors (from Pydantic: https://pydantic-docs.helpmanual.io/usage/models/#error-handling)\n            const msgTranslation = { \"value_error.missing\": true }[type];\n            if (msgTranslation === undefined) return;\n            const fieldName = loc[loc.length - 1];\n            const setState = {\n              username: setUsername,\n              password: setPassword,\n            }[fieldName];\n            if (setState === undefined) return;\n            setState((prevState) => ({\n              ...prevState,\n              errors: [msgTranslation],\n            }));\n          });\n        }\n\n        setForm({ isLoading: false, error: formError });\n      });\n  };\n\n  const onUsernameChange = (event) => {\n    const { value } = event.target;\n    setUsername((prevState) => ({\n      ...prevState,\n      value: value,\n      isDirty: true,\n    }));\n  };\n\n  const onPasswordChange = (event) => {\n    const { value } = event.target;\n    setPassword((prevState) => ({\n      ...prevState,\n      value: value,\n      isDirty: true,\n    }));\n  };\n\n  return (\n    <div>\n      <h1 class=\"text-center text-2xl\">Innskráning</h1>\n      <div class=\"pt-6 pb-2 my-2\">\n        <form onSubmit={onSubmit}>\n          {form.error && (\n            <div class=\"mb-4 text-red-700 font-bold\">{form.error}</div>\n          )}\n          <div class=\"mb-4\">\n            <label class=\"block text-sm font-bold mb-2\" for=\"username\">\n              Netfang\n            </label>\n            <input\n              class={classNames([\n                \"shadow appearance-none border rounded w-full py-2 px-3\",\n                (!username.isDirty && !!username.errors.length && \"error\") ||\n                  \"\",\n              ])}\n              name=\"username\"\n              type=\"text\"\n              disabled={form.isLoading}\n              value={username.value}\n              onInput={onUsernameChange}\n            />\n            {username.errors.map((error) => {\n              return <div class=\"text-red-700 text-sm my-2\">{error}</div>;\n            })}\n          </div>\n          <div class=\"mb-6\">\n            <label class=\"block text-sm font-bold mb-2\" for=\"password\">\n              Lykilorð\n            </label>\n            <input\n              class={classNames([\n                \"shadow appearance-none border rounded w-full py-2 px-3 mb-3\",\n                (!password.isDirty && !!password.errors.length && \"error\") ||\n                  \"\",\n              ])}\n              name=\"password\"\n              type=\"password\"\n              disabled={form.isLoading}\n              value={password.value}\n              onInput={onPasswordChange}\n            />\n            {password.errors.map((error) => {\n              return <div class=\"text-red-700 text-sm my-2\">{error}</div>;\n            })}\n          </div>\n          <div class=\"block sm:flex items-center justify-between\">\n            <div>\n              <button\n                class=\"btn-primary\"\n                type=\"submit\"\n                disabled={form.isLoading}\n              >\n                Innskrá\n              </button>\n            </div>\n            <div class=\"mt-4 sm:mt-0\">\n              <button\n                onClick={(event) => {\n                  event.stopPropagation();\n                  setScreen([\"password-recovery\", username.value]);\n                }}\n                class=\"no-underline\"\n              >\n                Gleymt lykilorð?\n              </button>\n            </div>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n};\n","import { h } from \"preact\";\nimport { useState } from \"preact/hooks\";\nimport { api } from \"../api\";\n\nconst classNames = (classArr) => classArr.filter((el) => el).join(\" \"); // filter falsy values\n\nexport const PasswordRecoveryForm = ({ setScreen, emailDefaultValue }) => {\n  const [form, setForm] = useState({\n    isLoading: false,\n    isSuccess: false,\n    error: null,\n  });\n\n  const [email, setEmail] = useState({\n    value: emailDefaultValue,\n    isDirty: false,\n  });\n\n  const onSubmit = (event) => {\n    event.preventDefault();\n    setForm({ isLoading: true, isSuccess: false, error: null });\n    api\n      .passwordRecovery(email.value)\n      .then((response) => {\n        setForm({ isLoading: false, error: null, isSuccess: true });\n      })\n      .catch(function (error) {\n        // remove dirty from email, meant for highlighting invalid fields until user edits\n        setEmail((prevState) => ({\n          ...prevState,\n          isDirty: false,\n        }));\n        let errorMessage =\n          error.response.data.detail || \"Óþekkt villa á vefþjóni\";\n        setForm({\n          isLoading: false,\n          isSuccess: false,\n          error: errorMessage,\n        });\n      });\n  };\n\n  const onEmailChange = (event) => {\n    const { value } = event.target;\n    setEmail({ value: value, isDirty: true });\n  };\n\n  return (\n    <div>\n      <h1 class=\"text-center text-2xl\">Sækja um nýtt lykilorð</h1>\n      <div class=\"pt-6 pb-2 my-2\">\n        <form onSubmit={onSubmit}>\n          {form.error && (\n            <div class=\"mb-4 text-red-700 font-bold\">{form.error}</div>\n          )}\n          {form.isSuccess && (\n            <div class=\"mb-4 text-green-600 font-bold\">\n              Tölvupóstur með leiðbeiningum var sendur á {email.value}\n            </div>\n          )}\n          <div class=\"mb-4\">\n            <label class=\"block text-sm font-bold mb-2\" for=\"email\">\n              Netfang\n            </label>\n            <input\n              class=\"shadow appearance-none border rounded w-full py-2 px-3\"\n              name=\"email\"\n              type=\"text\"\n              disabled={form.isLoading || form.isSuccess}\n              value={email.value}\n              onInput={onEmailChange}\n            />\n          </div>\n          <div class=\"block md:flex items-center justify-between\">\n            <div>\n              <button\n                class=\"btn-primary\"\n                type=\"submit\"\n                disabled={form.isLoading || form.isSuccess}\n              >\n                Senda\n              </button>\n            </div>\n\n            <div class=\"mt-4 md:mt-0\">\n              <button\n                onClick={(event) => {\n                  event.stopPropagation();\n                  setScreen([\"login\", email.value]);\n                }}\n                class=\"no-underline\"\n              >\n                Til baka\n              </button>\n            </div>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n};\n","import { h } from \"preact\";\nimport { useState } from \"preact/hooks\";\nimport { LoginForm } from \"./forms/login.jsx\";\nimport { PasswordRecoveryForm } from \"./forms/password-recovery.jsx\";\n\nexport const Login = (props) => {\n  const { onSuccess } = props;\n  const [[screen, emailDefaultValue], setScreen] = useState([\"login\", \"\"]);\n  const Form = { login: LoginForm, \"password-recovery\": PasswordRecoveryForm }[\n    screen\n  ];\n  return (\n    <div>\n      <Form\n        setScreen={setScreen}\n        emailDefaultValue={emailDefaultValue}\n        onSuccess={onSuccess}\n      />\n    </div>\n  );\n};\n","export const openModal = () => {\n  /* Handle opening and closing the modal window, return the el where Preact\n  can inject a login form or whatever.\n\n   */\n\n  const modalEl = document.getElementById(\"modal\");\n  modalEl.classList.remove(\"hidden\");\n  const cleanup = () => {\n    modalEl.classList.add(\"hidden\");\n  };\n  window.addEventListener(\"click\", (event) => {\n    // `Element.closest` traverses parents to find matching selector\n    // if we did not find #modal in ancestors we must have clicked somewhere outside\n    const clickedOutsideModalEl = !event.target.closest(\"#modal .inner\");\n    if (clickedOutsideModalEl) cleanup();\n  });\n\n  modalEl.querySelectorAll(\".close\").forEach((el) => {\n    el.addEventListener(\"click\", (event) => {\n      cleanup();\n    });\n  });\n\n  return [modalEl.querySelector(\".form\"), cleanup]; // the section that can be taken over by Preact\n};\n","import { h } from \"preact\";\n\nexport const MagnifyingGlass = (props) => {\n  return (\n    <svg\n      class=\"inline h-5 w-5\"\n      width=\"112px\"\n      height=\"112px\"\n      viewBox=\"0 0 112 112\"\n    >\n      <g transform=\"translate(-622.000000, -48.000000)\" fill-rule=\"nonzero\">\n        <path d=\"M726.662109,159.421875 C730.470703,159.421875 733.166016,156.492188 733.166016,152.742188 C733.166016,150.984375 732.580078,149.34375 731.291016,148.054688 L703.693359,120.398438 C709.494141,112.78125 712.951172,103.347656 712.951172,93.09375 C712.951172,68.3085938 692.677734,48.0351562 667.892578,48.0351562 C643.107422,48.0351562 622.833984,68.3085938 622.833984,93.09375 C622.833984,117.878906 643.107422,138.152344 667.892578,138.152344 C677.677734,138.152344 686.701172,134.988281 694.083984,129.714844 L721.857422,157.488281 C723.146484,158.777344 724.845703,159.421875 726.662109,159.421875 Z M667.892578,128.425781 C648.556641,128.425781 632.560547,112.429688 632.560547,93.09375 C632.560547,73.7578125 648.556641,57.7617188 667.892578,57.7617188 C687.228516,57.7617188 703.224609,73.7578125 703.224609,93.09375 C703.224609,112.429688 687.228516,128.425781 667.892578,128.425781 Z\"></path>\n      </g>\n    </svg>\n  );\n};\n\nexport const PersonFill = (props) => {\n  return (\n    <svg\n      width=\"112px\"\n      height=\"112px\"\n      class=\"inline h-5 w-5\"\n      viewBox=\"0 0 112 112\"\n    >\n      <g transform=\"translate(-628.000000, -53.000000)\" fill-rule=\"nonzero\">\n        <path d=\"M677.529297,104.109375 C690.068359,104.109375 700.966797,92.859375 700.966797,78.2109375 C700.966797,63.7382812 690.068359,53.015625 677.529297,53.015625 C664.990234,53.015625 654.091797,63.9726562 654.091797,78.328125 C654.091797,92.859375 664.931641,104.109375 677.529297,104.109375 Z M714.267578,158.367188 C723.525391,158.367188 726.806641,155.730469 726.806641,150.574219 C726.806641,135.457031 707.880859,114.597656 677.470703,114.597656 C647.119141,114.597656 628.193359,135.457031 628.193359,150.574219 C628.193359,155.730469 631.474609,158.367188 640.673828,158.367188 L714.267578,158.367188 Z\"></path>\n      </g>\n    </svg>\n  );\n};\n\nexport const TrashFill = (props) => {\n  return (\n    <svg\n      width=\"100px\"\n      height=\"113px\"\n      class=\"inline h-5 w-5\"\n      viewBox=\"0 0 100 113\"\n    >\n      <g fill-rule=\"nonzero\">\n        <path d=\"M25.4649 113H74.5868C80.9917 113 84.8657 109.441 85.124 103.046L88.4298 27.6956H96.1777C98.2955 27.6956 100 25.8905 100 23.7759C100 21.6613 98.2955 19.9078 96.1777 19.9078H72.624V12.1716C72.624 4.74487 67.6136 0 59.6591 0H40.3409C32.3864 0 27.4277 4.74487 27.4277 12.1716V19.9078H3.82231C1.7562 19.9078 0 21.7129 0 23.7759C0 25.8905 1.7562 27.6956 3.82231 27.6956H11.6736L14.9793 103.046C15.2376 109.441 19.0599 113 25.4649 113ZM35.6921 19.9078V12.6874C35.6921 9.7476 37.8099 7.68462 40.9607 7.68462H59.0909C62.2417 7.68462 64.4112 9.7476 64.4112 12.6874V19.9078H35.6921ZM28.4607 95.0005L26.1364 38.7841C26.0331 36.618 27.5826 35.0192 29.5455 35.0192C31.3533 35.0192 32.9029 36.7211 33.0062 38.7841L35.124 95.0005C35.1756 97.115 33.7293 98.817 31.7149 98.817C29.8554 98.817 28.5124 97.2697 28.4607 95.0005ZM46.5393 95.0005L46.4876 38.7841C46.4876 36.7211 48.1405 35.0192 50 35.0192C51.9112 35.0192 53.564 36.7211 53.564 38.7841V95.0005C53.564 97.115 51.8595 98.817 50 98.817C48.1405 98.817 46.5393 97.115 46.5393 95.0005ZM64.9793 95.0005L67.0971 38.7841C67.1488 36.7211 68.6983 35.0192 70.5578 35.0192C72.469 35.0192 74.0186 36.618 73.9669 38.7841L71.6426 95.0005C71.5909 97.2697 70.1963 98.817 68.2851 98.817C66.3223 98.817 64.9277 97.115 64.9793 95.0005Z\" />\n      </g>\n    </svg>\n  );\n};\n","import { h, render } from \"preact\";\nimport { useState, useRef, useEffect } from \"preact/hooks\";\nimport classNames from \"classnames\";\nimport { Login } from \"./accounts.jsx\";\nimport { openModal } from \"./modals\";\nimport { api } from \"./api\";\nimport { PersonFill, MagnifyingGlass } from \"./symbols.jsx\";\n\nconst LogoutButton = (props) => {\n  const onClick = (event) => {\n    event.stopPropagation();\n    event.preventDefault();\n    api.logout().then((response) => {\n      localStorage.removeItem(\"token\");\n      location.reload();\n    });\n  };\n  return (\n    <a\n      onClick={onClick}\n      href=\"/notendur/logout\"\n      role=\"button\"\n      class=\"text-sm font-bold text-powder-light\"\n    >\n      Útskrá\n    </a>\n  );\n};\n\nconst LoginButton = (props) => {\n  const { onLogin } = props;\n  const onClick = (event) => {\n    event.stopPropagation();\n    event.preventDefault();\n    const [el, closeModal] = openModal();\n    const onSuccess = () => {\n      onLogin();\n      closeModal();\n    };\n    render(<Login onSuccess={onSuccess} />, el);\n  };\n\n  return (\n    <a href=\"#\" role=\"button\" onClick={onClick} class=\"block p-2\">\n      <PersonFill />\n    </a>\n  );\n};\n\nconst User = (props) => {\n  const [user, setUser] = useState(document._user);\n  const onLogin = () => {\n    api\n      .getMe()\n      .then((response) => {\n        setUser(response.data);\n        document._user = response.data;\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n  };\n  if (!!user) {\n    return (\n      <div class=\"flex flex-row sm:flex-col\">\n        <div>\n          <a href=\"/notendur/stillingar\" class=\"text-sm block truncate\">\n            <span\n              class=\"sm:hidden inline-block pl-4\"\n              style=\"position: relative; top: 2px;\"\n            >\n              <PersonFill />\n            </span>\n            <span class=\"hidden sm:inline\">{user.email}</span>\n          </a>\n        </div>\n        <div class=\"order-first sm:order-last flex-grow\">\n          <LogoutButton />\n        </div>\n      </div>\n    );\n  }\n  return <LoginButton onLogin={onLogin} />;\n};\n\nexport const Navigation = () => {\n  const [isSearchExpanded, setIsSearchExpanded] = useState(\n    typeof document._searchQuery === \"string\"\n  );\n  const [value, setValue] = useState(document._searchQuery);\n\n  const onChange = (event) => {\n    setValue(event.target.value);\n  };\n\n  // When mobile user clicks to expand search, focus the input\n  const input = useRef(null);\n  useEffect(() => {\n    input.current && input.current.value && input.current.focus();\n  }, [isSearchExpanded]);\n\n  return (\n    <div class=\"flex justify-between items-center align-middle h-12\">\n      <div\n        class={classNames(\n          \"sm:order-2 sm:flex-grow text-center sm:px-10 sm:max-w-4xl\",\n          {\n            \"flex-grow\": isSearchExpanded,\n          }\n        )}\n      >\n        {!isSearchExpanded && (\n          <span\n            onClick={() => {\n              setIsSearchExpanded(true);\n            }}\n            role=\"button\"\n            class=\"sm:hidden block\"\n          >\n            <MagnifyingGlass />\n          </span>\n        )}\n        <div\n          class={classNames(\"sm:flex pr-4 sm:pr-0\", {\n            hidden: !isSearchExpanded,\n          })}\n        >\n          <form\n            class=\"search flex bg-white bg-opacity-25 rounded-md items-center mr-3 px-3 w-full\"\n            method=\"GET\"\n            action=\"/leit\"\n          >\n            <MagnifyingGlass />\n            <input\n              value={value}\n              ref={input}\n              onChange={onChange}\n              name=\"q\"\n              size=\"1\"\n              class=\"bg-transparent flex-grow py-2 px-2 text-sm font-thin overflow-hidden focus:outline-none\"\n              placeholder=\"Leit - t.d. 'Reitir ehf.', 'Brautarholt' eða 'gistiheimili'\"\n            />\n          </form>\n        </div>\n      </div>\n      <div\n        class={classNames(\"flex-grow sm:order-1 sm:flex-grow-0 text-center\", {\n          hidden: isSearchExpanded,\n          \"sm:block\": isSearchExpanded,\n        })}\n      >\n        <a href=\"/s\" class=\"font-black text-lg sm:text-xl\">\n          Planitor\n        </a>\n      </div>\n      <div class=\"order-last text-right\">\n        <User />\n      </div>\n    </div>\n  );\n};\n","import { Fragment, h } from \"preact\";\nimport { useState, useRef, useEffect } from \"preact/hooks\";\nimport { api } from \"./api\";\nimport { TrashFill } from \"./symbols.jsx\";\n\nconst Case = ({ serial, id }) => {\n  return <a href={`/cases/${id}`}>{serial}</a>;\n};\n\nconst Search = ({ search_query }) => {\n  return <a href={`/leit?q=${search_query}`}>„{search_query}“</a>;\n};\n\nconst Address = ({ name, hnitnum, radius }) => {\n  return (\n    <a href={`/hnit/${hnitnum}`}>\n      {name} {radius}\n    </a>\n  );\n};\n\nconst SelectWidget = ({ value, onChange, isDisabled, children }) => {\n  return (\n    <div class=\"inline-block relative text-sm sm:text-base\">\n      <select\n        value={value}\n        onChange={onChange}\n        disabled={isDisabled}\n        class=\"block appearance-none w-full border border-gray-400 hover:border-gray-500 px-1 sm:px-4 py-1 sm:py-2 pr-8 mr-3 rounded shadow leading-tight focus:outline-none focus:shadow-outline\"\n      >\n        {children}\n      </select>\n      <div class=\"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700\">\n        <svg class=\"fill-current h-4 w-4\" viewBox=\"0 0 20 20\">\n          <path d=\"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z\" />\n        </svg>\n      </div>\n    </div>\n  );\n};\n\nconst Entity = ({ kennitala, name }) => {\n  return <a href={`/f/${kennitala}`}>{name}</a>;\n};\n\nconst SubscriptionLoading = () => {\n  return (\n    <div class=\"rounded-lg shadow-sm p-4 w-full bg-white mb-4\">\n      <div class=\"animate-pulse flex flex-row\">\n        <div class=\"bg-gray-400 rounded w-3/4 mr-4 h-8\"></div>\n        <div class=\"bg-gray-400 rounded w-1/4 mr-4 h-8\"></div>\n        <div class=\"bg-gray-400 rounded w-16 h-8\"></div>\n      </div>\n    </div>\n  );\n};\n\nconst Subscription = (props) => {\n  const { subscription } = props;\n\n  const [isLoading, setLoading] = useState(false);\n  const [isDeleted, setDeleted] = useState(false);\n  const [data, setData] = useState(subscription);\n\n  const { id, active, immediate } = data;\n  let value = immediate ? \"immediate\" : \"weekly\";\n\n  if (!active) {\n    value = \"never\";\n  }\n\n  if (isDeleted) return null;\n\n  const onDelete = async (event) => {\n    const isConfirmed = confirm(\n      \"Ertu viss um að þú viljir fjárlægja þennan vaktara?\"\n    );\n    if (!isConfirmed) return;\n    setLoading(true);\n    const data = await api.deleteSubscription(id).then((response) => {\n      return response.data;\n    });\n    setDeleted(true);\n  };\n\n  const onChange = async (event) => {\n    const { value } = event.target;\n    const active = value !== \"never\";\n    const immediate = value === \"immediate\";\n    setLoading(true);\n    const data = await api\n      .updateSubscription(id, active, immediate)\n      .then((response) => {\n        return response.data;\n      });\n    setLoading(false);\n    setData(data);\n  };\n\n  return (\n    <div class=\"rounded-lg shadow-sm p-4 w-full bg-white mb-4\">\n      <div class=\"flex flex-row align-middle\">\n        <div class=\"mr-4 flex-grow font-bold py-1 text-sm sm:text-lg whitespace-no-wrap\">\n          {subscription.case && <Case {...subscription.case} />}\n          {subscription.search_query && (\n            <Search search_query={subscription.search_query} />\n          )}\n          {subscription.address && (\n            <Address\n              radius={subscription.radius || null}\n              {...subscription.address}\n            />\n          )}\n          {subscription.entity && <Entity {...subscription.entity} />}\n        </div>\n        <div>\n          <div class=\"flex justify-between items-center w-full\">\n            <SelectWidget\n              isDisabled={isLoading}\n              value={value}\n              onChange={onChange}\n            >\n              <Fragment>\n                <option value=\"never\">Afvirkja</option>\n                <option value=\"immediate\">Strax</option>\n                <option value=\"weekly\">Vikuleg</option>\n              </Fragment>\n            </SelectWidget>\n            <button\n              class=\"ml-3 sm:ml-6 text-gray-500\"\n              onClick={(event) => {\n                !isLoading && onDelete(event);\n              }}\n            >\n              <TrashFill />\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport const Subscriptions = () => {\n  const [subs, setSubs] = useState([]);\n  useEffect(async () => {\n    const subs = await api.getSubscriptions().then((response) => {\n      return response.data;\n    });\n    setSubs(subs);\n  }, []);\n  if (!subs.length) {\n    return (\n      <div>\n        <SubscriptionLoading />\n        <SubscriptionLoading />\n        <SubscriptionLoading />\n      </div>\n    );\n  }\n  return (\n    <div>\n      {subs.map((sub) => {\n        return <Subscription key={sub.id} subscription={sub} />;\n      })}\n    </div>\n  );\n};\n","import { h, render } from \"preact\";\nimport { useState } from \"preact/hooks\";\nimport classNames from \"classnames\";\n\nimport { api } from \"./api\";\nimport { openModal } from \"./modals\";\n\nconst Button = (props) => {\n  const { loading, onClick, hover, setHover, following, defaultLabel } = props;\n  return (\n    <button\n      class={classNames(\n        \"px-4 py-2 border rounded-lg font-bold sm:inline block mx-auto\",\n        {\n          \"text-gray-500 border-gray-500\": loading,\n          \"bg-midnight text-white\": following && !loading,\n          \"text-midnight\": !following && !loading,\n          \"border-midnight\": !loading,\n        }\n      )}\n      onClick={onClick}\n      onMouseOver={(event) => {\n        setHover(true);\n      }}\n      onMouseOut={(event) => {\n        setHover(false);\n      }}\n    >\n      {(() => {\n        if (hover) {\n          return following ? \"Afvakta\" : defaultLabel || \"Vakta\";\n        } else {\n          return following ? \"Vaktað\" : defaultLabel || \"Vakta\";\n        }\n      })()}\n    </button>\n  );\n};\n\nconst Banner = (props) => {\n  const Link = () => {\n    return (\n      <a class=\"text-midnight underline\" href=\"mailto:hallo@planitor.io\">\n        hallo@planitor.io\n      </a>\n    );\n  };\n  return (\n    <p class=\"text-center\">\n      Vaktarinn stendur öllum til boða gegn mánaðargjaldi. <br />\n      Til að fá aðgang sendu okkur línu á <Link />.\n    </p>\n  );\n};\n\nexport const FollowCase = (props) => {\n  const { id, state, defaultLabel } = props;\n  const [hover, setHover] = useState(false);\n  const [following, setFollowing] = useState(state === \"following\");\n  const [form, setForm] = useState({ isLoading: false, error: null });\n  const onClick = (event) => {\n    event.preventDefault();\n    event.stopPropagation();\n    if (form.isLoading) return;\n    const toggle = () => {\n      setForm({ isLoading: true, error: null });\n      (following ? api.unfollowCase(id) : api.followCase(id))\n        .then((response) => {\n          setFollowing(!following);\n          setHover(false);\n          setForm({ isLoading: false, error: null });\n        })\n        .catch(function (error) {\n          setForm({ isLoading: false, error: error });\n        });\n    };\n    if (document._user === null) {\n      const [el, closeModal] = openModal();\n      render(<Banner />, el);\n    } else {\n      toggle();\n    }\n  };\n  return (\n    <Button\n      loading={form.isLoading}\n      following={following}\n      hover={hover}\n      setHover={setHover}\n      onClick={onClick}\n      defaultLabel={defaultLabel}\n    />\n  );\n};\n\nexport const FollowAddress = (props) => {\n  const { hnitnum, state } = props;\n  const [hover, setHover] = useState(false);\n  const [following, setFollowing] = useState(state === \"following\");\n  const [form, setForm] = useState({ isLoading: false, error: null });\n  const onClick = (event) => {\n    event.preventDefault();\n    event.stopPropagation();\n    if (form.isLoading) return;\n    const toggle = () => {\n      setForm({ isLoading: true, error: null });\n      (following ? api.unfollowAddress(hnitnum) : api.followAddress(hnitnum))\n        .then((response) => {\n          setFollowing(!following);\n          setHover(false);\n          setForm({ isLoading: false, error: null });\n        })\n        .catch(function (error) {\n          setForm({ isLoading: false, error: error });\n        });\n    };\n    if (document._user === null) {\n      const [el, closeModal] = openModal();\n      render(<Banner />, el);\n    } else {\n      toggle();\n    }\n  };\n  return (\n    <Button\n      loading={form.isLoading}\n      following={following}\n      hover={hover}\n      setHover={setHover}\n      onClick={onClick}\n    />\n  );\n};\n","import { h } from \"preact\";\nimport { useState } from \"preact/hooks\";\nimport { api } from \"../api\";\n\nconst saveLocalToken = (token) => localStorage.setItem(\"token\", token);\n\nexport const NewPasswordForm = ({ token }) => {\n  const [form, setForm] = useState({\n    isSuccess: false,\n    isLoading: false,\n    error: null,\n  });\n  const [password, setPassword] = useState(\"\");\n\n  const onChange = (event) => {\n    setPassword(event.target.value);\n  };\n\n  const onSubmit = (event) => {\n    event.preventDefault();\n    setForm({ isLoading: true, isSuccess: false, error: null });\n    api\n      .resetPassword(password, token)\n      .then((response) => {\n        saveLocalToken(response.data.access_token);\n        setForm({ isLoading: false, error: null, isSuccess: true });\n      })\n      .catch(function (error) {\n        // remove dirty, meant for highlighting invalid fields until user edits\n        let errorMessage =\n          error.response.data.detail || \"Óþekkt villa á vefþjóni\";\n        setForm({ isLoading: false, isSuccess: false, error: errorMessage });\n      });\n  };\n\n  return (\n    <div>\n      <h1 class=\"text-center text-2xl\">Nýtt lykilorð</h1>\n      <div class=\"py-2 my-2\"></div>\n      <form onSubmit={onSubmit}>\n        {form.error && (\n          <div class=\"mb-4 text-red-700 font-bold\">{form.error}</div>\n        )}\n        {form.isSuccess && (\n          <div class=\"mb-4 text-green-600 font-bold\">\n            Lykilorðið hefur verið uppfært.\n          </div>\n        )}\n        <div class=\"mb-4\">\n          <input\n            class=\"shadow appearance-none border rounded w-full py-2 px-3\"\n            name=\"password\"\n            type=\"password\"\n            disabled={form.isLoading || form.isSuccess}\n            value={password.value}\n            onInput={onChange}\n          />\n        </div>\n        <div class=\"block md:flex items-center justify-between\">\n          <div>\n            <button\n              class=\"btn-primary\"\n              type=\"submit\"\n              disabled={form.isLoading || form.isSuccess}\n            >\n              Vista\n            </button>\n          </div>\n        </div>\n      </form>\n    </div>\n  );\n};\n","import { h } from \"preact\";\nimport { api } from \"./api\";\n\nexport let mapkit = window[\"mapkit\"];\n\n// Render map only when it is in the viewport\ndocument.addEventListener(\"lazybeforeunveil\", function (e) {\n  let el = e.target;\n  if (el.classList.contains(\"map\")) {\n    var address = new mapkit.Coordinate(\n      parseFloat(el.dataset.lat),\n      parseFloat(el.dataset.lon)\n    );\n    var region = new mapkit.CoordinateRegion(\n      address,\n      new mapkit.CoordinateSpan(0.03, 0.04)\n    );\n    var map = new mapkit.Map(el);\n\n    var addressAnnotation = new mapkit.MarkerAnnotation(address, {\n      color: \"#f4a56d\",\n      title: el.dataset.address,\n    });\n    map.showItems([addressAnnotation]);\n\n    map.region = region;\n  }\n});\n\nexport async function getEntityMapOptions(kennitala) {\n  const addresses = await api.getEntityAddresses(kennitala).then((response) => {\n    return response.data.addresses;\n  });\n  if (addresses.length === 0) return null;\n\n  var north = addresses[0].lat,\n    south = north,\n    west = addresses[0].lon,\n    east = west,\n    pins = [];\n\n  // Shift direction variables to the outermost parts of pins to create a boundary region\n  for (var address of addresses) {\n    const { lat, lon, label } = address;\n    pins.push(\n      new mapkit.MarkerAnnotation(new mapkit.Coordinate(lat, lon), {\n        title: label,\n      })\n    );\n    if (lat > north) north = lat;\n    if (lat < south) south = lat;\n    if (lon < west) west = lon;\n    if (lon > east) east = lon;\n  }\n\n  if (addresses.length === 1) {\n    return {\n      annotations: pins,\n      region: new mapkit.CoordinateRegion(\n        new mapkit.Coordinate(north, west),\n        new mapkit.CoordinateSpan(0.01, 0.01)\n      ),\n    };\n  } else {\n    const latDiff = Math.abs(north - south) * 0.1;\n    const lonDiff = Math.abs(east - west) * 0.1;\n    const region = new mapkit.BoundingRegion(\n      north + latDiff,\n      east + lonDiff,\n      south - latDiff,\n      west - lonDiff\n    ).toCoordinateRegion();\n    return {\n      annotations: pins,\n      region: region,\n    };\n  }\n}\n","import { h, render } from \"preact\";\n\nimport { Navigation } from \"./navigation.jsx\";\nimport { Subscriptions } from \"./subscriptions.jsx\";\nimport { FollowCase, FollowAddress } from \"./follow.jsx\";\nimport { NewPasswordForm } from \"./forms/new-password.jsx\";\nimport { openModal } from \"./modals.js\";\nimport { mapkit, getEntityMapOptions } from \"./maps.jsx\";\n\nmapkit.init({\n  authorizationCallback: (done) => {\n    fetch(\"/mapkit-token\")\n      .then((res) => res.text())\n      .then((token) => done(token))\n      .catch((error) => {\n        console.error(error);\n      });\n  },\n});\n\nconst passwordRecoveryEl = document.getElementById(\"password-recovery\");\nif (passwordRecoveryEl) {\n  const [el, closeModal] = openModal();\n  render(<NewPasswordForm token={passwordRecoveryEl.dataset.token} />, el);\n}\n\nconst navigationEl = document.getElementById(\"navigation\");\nif (navigationEl) {\n  render(<Navigation />, navigationEl);\n}\n\nconst subscriptionsEl = document.getElementById(\"subscriptions\");\nif (subscriptionsEl) {\n  render(<Subscriptions />, subscriptionsEl);\n}\n\nmapkit.addEventListener(\"configuration-change\", function (event) {\n  if (event.status === \"Initialized\") {\n    [...document.querySelectorAll(\".entity-map\")].forEach(async (el) => {\n      const options = await getEntityMapOptions(el.dataset.kennitala);\n      if (options) new mapkit.Map(el, options);\n    });\n  }\n});\n\n[...document.querySelectorAll(\".follow-case\")].forEach((button) => {\n  const defaultLabel = button.innerText;\n  button.innerHTML = \"\";\n  render(\n    <FollowCase\n      id={button.dataset.id}\n      state={button.dataset.state}\n      defaultLabel={defaultLabel}\n    />,\n    button\n  );\n});\n\n[...document.querySelectorAll(\".follow-address\")].forEach((button) => {\n  render(\n    <FollowAddress\n      hnitnum={button.dataset.hnitnum}\n      state={button.dataset.state}\n    />,\n    button\n  );\n});\n"],"names":["authHeaders","headers","Authorization","localStorage","getItem","api","logInGetToken","email","password","params","URLSearchParams","append","axios","post","getMe","get","passwordRecovery","resetPassword","token","new_password","logout","followCase","id","unfollowCase","delete","followAddress","hnitnum","unfollowAddress","getEntityAddresses","kennitala","getSubscriptions","updateSubscription","active","immediate","deleteSubscription","classNames","classArr","filter","el","join","LoginForm","props","onSuccess","setScreen","username","setUsername","useState","value","isDirty","errors","setPassword","form","setForm","isLoading","error","h","class","onSubmit","event","preventDefault","then","response","setItem","data","access_token","catch","forEach","setState","prevState","detail","formError","Array","isArray","loc","msg","type","msgTranslation","undefined","fieldName","length","for","name","disabled","onInput","target","map","onClick","stopPropagation","PasswordRecoveryForm","emailDefaultValue","isSuccess","setEmail","errorMessage","Login","screen","login","openModal","modalEl","document","getElementById","classList","remove","cleanup","add","window","addEventListener","closest","querySelectorAll","querySelector","MagnifyingGlass","width","height","viewBox","transform","d","PersonFill","TrashFill","LogoutButton","removeItem","location","reload","href","role","LoginButton","onLogin","closeModal","render","User","user","setUser","_user","style","console","log","Navigation","isSearchExpanded","setIsSearchExpanded","_searchQuery","setValue","input","useRef","useEffect","current","focus","hidden","method","action","ref","onChange","size","placeholder","Case","serial","Search","search_query","Address","radius","SelectWidget","isDisabled","children","Entity","SubscriptionLoading","Subscription","subscription","setLoading","isDeleted","setDeleted","setData","case","address","entity","async","Fragment","confirm","onDelete","Subscriptions","subs","setSubs","sub","key","Button","loading","hover","setHover","following","defaultLabel","onMouseOver","onMouseOut","Banner","FollowCase","state","setFollowing","FollowAddress","NewPasswordForm","saveLocalToken","mapkit","e","contains","Coordinate","parseFloat","dataset","lat","lon","region","CoordinateRegion","CoordinateSpan","Map","addressAnnotation","MarkerAnnotation","color","title","showItems","init","authorizationCallback","done","fetch","res","text","passwordRecoveryEl","navigationEl","subscriptionsEl","status","options","addresses","north","south","west","east","pins","label","push","annotations","latDiff","Math","abs","lonDiff","BoundingRegion","toCoordinateRegion","getEntityMapOptions","button","innerText","innerHTML"],"mappings":"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"}