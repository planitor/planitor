{"version":3,"file":"index-a83dfdcf.js","sources":["../src/api.js","../src/forms/login.jsx","../src/forms/password-recovery.jsx","../src/accounts.jsx","../src/modals.js","../src/symbols.jsx","../src/navigation.jsx","../src/subscriptions.jsx","../src/follow.jsx","../src/forms/new-password.jsx","../src/maps.jsx","../src/app.jsx"],"sourcesContent":["import axios from \"axios\";\n\nfunction authHeaders() {\n  const token = localStorage.getItem(\"token\");\n  return {\n    headers: {\n      Authorization: `Bearer ${token}`,\n    },\n  };\n}\n\nexport const api = {\n  logInGetToken(email, password) {\n    const params = new URLSearchParams();\n    // Using FastAPI OAuth2PasswordRequestForm which requires `username` not email\n    params.append(\"username\", email);\n    params.append(\"password\", password);\n    return axios.post(`/notendur/login/access-token`, params);\n  },\n  getMe() {\n    return axios.get(`/notendur/me`, authHeaders());\n  },\n  passwordRecovery(email) {\n    return axios.post(`/notendur/password-recovery/${email}`);\n  },\n  resetPassword(password, token) {\n    return axios.post(`/notendur/reset-password`, {\n      new_password: password,\n      token,\n    });\n  },\n  logout() {\n    return axios.get(\"/notendur/logout\");\n  },\n  followCase(id) {\n    return axios.post(`/subscriptions/cases/${id}`, null, authHeaders());\n  },\n  unfollowCase(id) {\n    return axios.delete(`/subscriptions/cases/${id}`, authHeaders());\n  },\n  followAddress(hnitnum) {\n    return axios.post(\n      `/subscriptions/addresses/${hnitnum}`,\n      null,\n      authHeaders()\n    );\n  },\n  unfollowAddress(hnitnum) {\n    return axios.delete(`/subscriptions/addresses/${hnitnum}`, authHeaders());\n  },\n  getEntityAddresses(kennitala) {\n    return axios.get(`/entities/${kennitala}/addresses`);\n  },\n  getSubscriptions() {\n    return axios.get(\"/me/subscriptions\", authHeaders());\n  },\n  updateSubscription(id, data) {\n    return axios.post(`/me/subscriptions/${id}`, data, authHeaders());\n  },\n  deleteSubscription(id) {\n    return axios.delete(`/me/subscriptions/${id}`, authHeaders());\n  },\n};\n","import { h } from \"preact\";\nimport { useState } from \"preact/hooks\";\nimport { api } from \"../api\";\n\nconst classNames = (classArr) => classArr.filter((el) => el).join(\" \"); // filter falsy values\n\nexport const LoginForm = (props) => {\n  const { onSuccess, setScreen } = props;\n  const [username, setUsername] = useState({\n    value: \"\",\n    isDirty: false,\n    errors: [],\n  });\n  const [password, setPassword] = useState({\n    value: \"\",\n    isDirty: false,\n    errors: [],\n  });\n  const [form, setForm] = useState({ isLoading: false, error: null });\n\n  const onSubmit = (event) => {\n    event.preventDefault();\n    setForm({ isLoading: true, error: null });\n    api\n      .logInGetToken(username.value, password.value)\n      .then((response) => {\n        localStorage.setItem(\"token\", response.data.access_token);\n        onSuccess();\n      })\n      .catch(function (error) {\n        // handle error\n\n        // remove dirty from fields, meant for highlighting invalid fields until user edits\n        [setUsername, setPassword].forEach((setState) => {\n          setState((prevState) => ({\n            ...prevState,\n            errors: [],\n            isDirty: false,\n          }));\n        });\n\n        const errors = error.response.data.detail;\n\n        let formError = null;\n\n        if (typeof errors == \"string\") {\n          formError = errors;\n        }\n\n        if (Array.isArray(errors)) {\n          errors.forEach((error) => {\n            const { loc, msg, type } = error;\n            // The API has types of errors (from Pydantic: https://pydantic-docs.helpmanual.io/usage/models/#error-handling)\n            const msgTranslation = { \"value_error.missing\": true }[type];\n            if (msgTranslation === undefined) return;\n            const fieldName = loc[loc.length - 1];\n            const setState = {\n              username: setUsername,\n              password: setPassword,\n            }[fieldName];\n            if (setState === undefined) return;\n            setState((prevState) => ({\n              ...prevState,\n              errors: [msgTranslation],\n            }));\n          });\n        }\n\n        setForm({ isLoading: false, error: formError });\n      });\n  };\n\n  const onUsernameChange = (event) => {\n    const { value } = event.target;\n    setUsername((prevState) => ({\n      ...prevState,\n      value: value,\n      isDirty: true,\n    }));\n  };\n\n  const onPasswordChange = (event) => {\n    const { value } = event.target;\n    setPassword((prevState) => ({\n      ...prevState,\n      value: value,\n      isDirty: true,\n    }));\n  };\n\n  return (\n    <div>\n      <h1 class=\"text-center text-2xl\">Innskráning</h1>\n      <div class=\"pt-6 pb-2 my-2\">\n        <form onSubmit={onSubmit}>\n          {form.error && (\n            <div class=\"mb-4 text-red-700 font-bold\">{form.error}</div>\n          )}\n          <div class=\"mb-4\">\n            <label class=\"block text-sm font-bold mb-2\" for=\"username\">\n              Netfang\n            </label>\n            <input\n              class={classNames([\n                \"shadow appearance-none border rounded w-full py-2 px-3\",\n                (!username.isDirty && !!username.errors.length && \"error\") ||\n                  \"\",\n              ])}\n              name=\"username\"\n              type=\"text\"\n              disabled={form.isLoading}\n              value={username.value}\n              onInput={onUsernameChange}\n            />\n            {username.errors.map((error) => {\n              return <div class=\"text-red-700 text-sm my-2\">{error}</div>;\n            })}\n          </div>\n          <div class=\"mb-6\">\n            <label class=\"block text-sm font-bold mb-2\" for=\"password\">\n              Lykilorð\n            </label>\n            <input\n              class={classNames([\n                \"shadow appearance-none border rounded w-full py-2 px-3 mb-3\",\n                (!password.isDirty && !!password.errors.length && \"error\") ||\n                  \"\",\n              ])}\n              name=\"password\"\n              type=\"password\"\n              disabled={form.isLoading}\n              value={password.value}\n              onInput={onPasswordChange}\n            />\n            {password.errors.map((error) => {\n              return <div class=\"text-red-700 text-sm my-2\">{error}</div>;\n            })}\n          </div>\n          <div class=\"block sm:flex items-center justify-between\">\n            <div>\n              <button\n                class=\"btn-primary\"\n                type=\"submit\"\n                disabled={form.isLoading}\n              >\n                Innskrá\n              </button>\n            </div>\n            <div class=\"mt-4 sm:mt-0\">\n              <button\n                onClick={(event) => {\n                  event.stopPropagation();\n                  setScreen([\"password-recovery\", username.value]);\n                }}\n                class=\"no-underline\"\n              >\n                Gleymt lykilorð?\n              </button>\n            </div>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n};\n","import { h } from \"preact\";\nimport { useState } from \"preact/hooks\";\nimport { api } from \"../api\";\n\nconst classNames = (classArr) => classArr.filter((el) => el).join(\" \"); // filter falsy values\n\nexport const PasswordRecoveryForm = ({ setScreen, emailDefaultValue }) => {\n  const [form, setForm] = useState({\n    isLoading: false,\n    isSuccess: false,\n    error: null,\n  });\n\n  const [email, setEmail] = useState({\n    value: emailDefaultValue,\n    isDirty: false,\n  });\n\n  const onSubmit = (event) => {\n    event.preventDefault();\n    setForm({ isLoading: true, isSuccess: false, error: null });\n    api\n      .passwordRecovery(email.value)\n      .then((response) => {\n        setForm({ isLoading: false, error: null, isSuccess: true });\n      })\n      .catch(function (error) {\n        // remove dirty from email, meant for highlighting invalid fields until user edits\n        setEmail((prevState) => ({\n          ...prevState,\n          isDirty: false,\n        }));\n        let errorMessage =\n          error.response.data.detail || \"Óþekkt villa á vefþjóni\";\n        setForm({\n          isLoading: false,\n          isSuccess: false,\n          error: errorMessage,\n        });\n      });\n  };\n\n  const onEmailChange = (event) => {\n    const { value } = event.target;\n    setEmail({ value: value, isDirty: true });\n  };\n\n  return (\n    <div>\n      <h1 class=\"text-center text-2xl\">Sækja um nýtt lykilorð</h1>\n      <div class=\"pt-6 pb-2 my-2\">\n        <form onSubmit={onSubmit}>\n          {form.error && (\n            <div class=\"mb-4 text-red-700 font-bold\">{form.error}</div>\n          )}\n          {form.isSuccess && (\n            <div class=\"mb-4 text-green-600 font-bold\">\n              Tölvupóstur með leiðbeiningum var sendur á {email.value}\n            </div>\n          )}\n          <div class=\"mb-4\">\n            <label class=\"block text-sm font-bold mb-2\" for=\"email\">\n              Netfang\n            </label>\n            <input\n              class=\"shadow appearance-none border rounded w-full py-2 px-3\"\n              name=\"email\"\n              type=\"text\"\n              disabled={form.isLoading || form.isSuccess}\n              value={email.value}\n              onInput={onEmailChange}\n            />\n          </div>\n          <div class=\"block md:flex items-center justify-between\">\n            <div>\n              <button\n                class=\"btn-primary\"\n                type=\"submit\"\n                disabled={form.isLoading || form.isSuccess}\n              >\n                Senda\n              </button>\n            </div>\n\n            <div class=\"mt-4 md:mt-0\">\n              <button\n                onClick={(event) => {\n                  event.stopPropagation();\n                  setScreen([\"login\", email.value]);\n                }}\n                class=\"no-underline\"\n              >\n                Til baka\n              </button>\n            </div>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n};\n","import { h } from \"preact\";\nimport { useState } from \"preact/hooks\";\nimport { LoginForm } from \"./forms/login.jsx\";\nimport { PasswordRecoveryForm } from \"./forms/password-recovery.jsx\";\n\nexport const Login = (props) => {\n  const { onSuccess } = props;\n  const [[screen, emailDefaultValue], setScreen] = useState([\"login\", \"\"]);\n  const Form = { login: LoginForm, \"password-recovery\": PasswordRecoveryForm }[\n    screen\n  ];\n  return (\n    <div>\n      <Form\n        setScreen={setScreen}\n        emailDefaultValue={emailDefaultValue}\n        onSuccess={onSuccess}\n      />\n    </div>\n  );\n};\n","export const openModal = () => {\n  /* Handle opening and closing the modal window, return the el where Preact\n  can inject a login form or whatever.\n\n   */\n\n  const modalEl = document.getElementById(\"modal\");\n  modalEl.classList.remove(\"hidden\");\n  const cleanup = () => {\n    modalEl.classList.add(\"hidden\");\n  };\n  window.addEventListener(\"click\", (event) => {\n    // `Element.closest` traverses parents to find matching selector\n    // if we did not find #modal in ancestors we must have clicked somewhere outside\n    const clickedOutsideModalEl = !event.target.closest(\"#modal .inner\");\n    if (clickedOutsideModalEl) cleanup();\n  });\n\n  modalEl.querySelectorAll(\".close\").forEach((el) => {\n    el.addEventListener(\"click\", (event) => {\n      cleanup();\n    });\n  });\n\n  return [modalEl.querySelector(\".form\"), cleanup]; // the section that can be taken over by Preact\n};\n","import { h } from \"preact\";\n\nexport const MagnifyingGlass = (props) => {\n  return (\n    <svg\n      class=\"inline h-5 w-5\"\n      width=\"112px\"\n      height=\"112px\"\n      viewBox=\"0 0 112 112\"\n    >\n      <g transform=\"translate(-622.000000, -48.000000)\" fill-rule=\"nonzero\">\n        <path d=\"M726.662109,159.421875 C730.470703,159.421875 733.166016,156.492188 733.166016,152.742188 C733.166016,150.984375 732.580078,149.34375 731.291016,148.054688 L703.693359,120.398438 C709.494141,112.78125 712.951172,103.347656 712.951172,93.09375 C712.951172,68.3085938 692.677734,48.0351562 667.892578,48.0351562 C643.107422,48.0351562 622.833984,68.3085938 622.833984,93.09375 C622.833984,117.878906 643.107422,138.152344 667.892578,138.152344 C677.677734,138.152344 686.701172,134.988281 694.083984,129.714844 L721.857422,157.488281 C723.146484,158.777344 724.845703,159.421875 726.662109,159.421875 Z M667.892578,128.425781 C648.556641,128.425781 632.560547,112.429688 632.560547,93.09375 C632.560547,73.7578125 648.556641,57.7617188 667.892578,57.7617188 C687.228516,57.7617188 703.224609,73.7578125 703.224609,93.09375 C703.224609,112.429688 687.228516,128.425781 667.892578,128.425781 Z\"></path>\n      </g>\n    </svg>\n  );\n};\n\nexport const PersonFill = (props) => {\n  return (\n    <svg\n      width=\"112px\"\n      height=\"112px\"\n      class=\"inline h-5 w-5\"\n      viewBox=\"0 0 112 112\"\n    >\n      <g transform=\"translate(-628.000000, -53.000000)\" fill-rule=\"nonzero\">\n        <path d=\"M677.529297,104.109375 C690.068359,104.109375 700.966797,92.859375 700.966797,78.2109375 C700.966797,63.7382812 690.068359,53.015625 677.529297,53.015625 C664.990234,53.015625 654.091797,63.9726562 654.091797,78.328125 C654.091797,92.859375 664.931641,104.109375 677.529297,104.109375 Z M714.267578,158.367188 C723.525391,158.367188 726.806641,155.730469 726.806641,150.574219 C726.806641,135.457031 707.880859,114.597656 677.470703,114.597656 C647.119141,114.597656 628.193359,135.457031 628.193359,150.574219 C628.193359,155.730469 631.474609,158.367188 640.673828,158.367188 L714.267578,158.367188 Z\"></path>\n      </g>\n    </svg>\n  );\n};\n\nexport const TrashFill = (props) => {\n  return (\n    <svg\n      width=\"100px\"\n      height=\"113px\"\n      class=\"inline h-5 w-5\"\n      viewBox=\"0 0 100 113\"\n    >\n      <g fill-rule=\"nonzero\">\n        <path d=\"M25.4649 113H74.5868C80.9917 113 84.8657 109.441 85.124 103.046L88.4298 27.6956H96.1777C98.2955 27.6956 100 25.8905 100 23.7759C100 21.6613 98.2955 19.9078 96.1777 19.9078H72.624V12.1716C72.624 4.74487 67.6136 0 59.6591 0H40.3409C32.3864 0 27.4277 4.74487 27.4277 12.1716V19.9078H3.82231C1.7562 19.9078 0 21.7129 0 23.7759C0 25.8905 1.7562 27.6956 3.82231 27.6956H11.6736L14.9793 103.046C15.2376 109.441 19.0599 113 25.4649 113ZM35.6921 19.9078V12.6874C35.6921 9.7476 37.8099 7.68462 40.9607 7.68462H59.0909C62.2417 7.68462 64.4112 9.7476 64.4112 12.6874V19.9078H35.6921ZM28.4607 95.0005L26.1364 38.7841C26.0331 36.618 27.5826 35.0192 29.5455 35.0192C31.3533 35.0192 32.9029 36.7211 33.0062 38.7841L35.124 95.0005C35.1756 97.115 33.7293 98.817 31.7149 98.817C29.8554 98.817 28.5124 97.2697 28.4607 95.0005ZM46.5393 95.0005L46.4876 38.7841C46.4876 36.7211 48.1405 35.0192 50 35.0192C51.9112 35.0192 53.564 36.7211 53.564 38.7841V95.0005C53.564 97.115 51.8595 98.817 50 98.817C48.1405 98.817 46.5393 97.115 46.5393 95.0005ZM64.9793 95.0005L67.0971 38.7841C67.1488 36.7211 68.6983 35.0192 70.5578 35.0192C72.469 35.0192 74.0186 36.618 73.9669 38.7841L71.6426 95.0005C71.5909 97.2697 70.1963 98.817 68.2851 98.817C66.3223 98.817 64.9277 97.115 64.9793 95.0005Z\" />\n      </g>\n    </svg>\n  );\n};\n\nexport const BadgePlusRadiowavesRight = (props) => {\n  return (\n    <svg width=\"105\" height=\"84\" viewBox=\"0 0 105 84\" class=\"inline h-5 w-5\">\n      <path d=\"M87.9364 83.4273C89.457 84.4816 91.5688 84.0598 92.7936 82.3309C100.523 71.2822 105 57.0707 105 42.0158C105 26.9609 100.481 12.7072 92.7936 1.65849C91.5688 -0.0705046 89.4992 -0.492211 87.9364 0.604225C86.3315 1.70066 86.078 3.80919 87.3029 5.58036C94.0607 15.5748 98.2844 28.3947 98.2844 42.0158C98.2844 55.6369 94.2297 68.6254 87.2607 78.4512C86.0358 80.1802 86.2892 82.2887 87.9364 83.4273ZM70.8729 71.9147C72.5201 73.0112 74.5475 72.5894 75.7301 70.9026C81.3476 63.1432 84.5575 52.8114 84.5575 42.0158C84.5575 31.1779 81.3898 20.8461 75.7301 13.0867C74.5052 11.4421 72.5201 11.0204 70.8729 12.1168C69.3101 13.2132 69.0567 15.2796 70.3238 17.0929C74.8854 23.8402 77.7574 32.6961 77.7574 42.0158C77.7574 51.3355 75.0121 60.2756 70.2816 66.9386C69.0567 68.7519 69.3101 70.8183 70.8729 71.9147ZM21.9208 63.8601C33.7892 63.8601 43.7993 53.95 43.7993 42.0158C43.7993 30.0393 33.9159 20.1292 21.9208 20.1292C9.92558 20.1292 0 30.0393 0 42.0158C0 54.0344 9.92558 63.8601 21.9208 63.8601ZM54.0205 60.5287C55.4988 61.5407 57.5261 61.2034 58.751 59.5587C62.0877 55.1308 64.0306 48.6365 64.0306 42.0158C64.0306 35.395 62.0455 28.9429 58.751 24.4306C57.5261 22.786 55.4988 22.4486 54.0205 23.4607C52.2043 24.6836 51.9509 26.8343 53.3447 28.6898C55.7522 31.9792 57.2305 36.9975 57.2305 42.0158C57.2305 47.0341 55.71 52.0524 53.3025 55.3838C51.9932 57.1972 52.2466 59.2635 54.0205 60.5287ZM21.9208 56.2273C20.4002 56.2273 19.1331 55.173 19.1331 53.5705V44.5882H10.8126C9.37651 44.5882 8.19389 43.4074 8.19389 41.9736C8.19389 40.582 9.37651 39.359 10.8126 39.359H19.1331V30.4188C19.1331 28.8164 20.4002 27.8043 21.9208 27.8043C23.399 27.8043 24.7084 28.8164 24.7084 30.4188V39.359H32.9867C34.465 39.359 35.6054 40.582 35.6054 41.9736C35.6054 43.4074 34.465 44.5882 32.9867 44.5882H24.7084V53.5705C24.7084 55.173 23.399 56.2273 21.9208 56.2273Z\" />\n    </svg>\n  );\n};\n","import { h, render } from \"preact\";\nimport { useState, useRef, useEffect } from \"preact/hooks\";\nimport classNames from \"classnames\";\nimport { Login } from \"./accounts.jsx\";\nimport { openModal } from \"./modals\";\nimport { api } from \"./api\";\nimport { PersonFill, MagnifyingGlass } from \"./symbols.jsx\";\n\nconst LogoutButton = (props) => {\n  const onClick = (event) => {\n    event.stopPropagation();\n    event.preventDefault();\n    api.logout().then((response) => {\n      localStorage.removeItem(\"token\");\n      location.reload();\n    });\n  };\n  return (\n    <a\n      onClick={onClick}\n      href=\"/notendur/logout\"\n      role=\"button\"\n      class=\"text-sm font-bold text-powder-light\"\n    >\n      Útskrá\n    </a>\n  );\n};\n\nconst LoginButton = (props) => {\n  const { onLogin } = props;\n  const onClick = (event) => {\n    event.stopPropagation();\n    event.preventDefault();\n    const [el, closeModal] = openModal();\n    const onSuccess = () => {\n      onLogin();\n      closeModal();\n    };\n    render(<Login onSuccess={onSuccess} />, el);\n  };\n\n  return (\n    <a href=\"#\" role=\"button\" onClick={onClick} class=\"block p-2\">\n      <PersonFill />\n    </a>\n  );\n};\n\nconst User = (props) => {\n  const [user, setUser] = useState(document._user);\n  const onLogin = () => {\n    api\n      .getMe()\n      .then((response) => {\n        setUser(response.data);\n        document._user = response.data;\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n  };\n  if (!!user) {\n    return (\n      <div class=\"flex flex-row sm:flex-col\">\n        <div>\n          <a href=\"/notendur/stillingar\" class=\"text-sm block truncate\">\n            <span\n              class=\"sm:hidden inline-block pl-4\"\n              style=\"position: relative; top: 2px;\"\n            >\n              <PersonFill />\n            </span>\n            <span class=\"hidden sm:inline\">{user.email}</span>\n          </a>\n        </div>\n        <div class=\"order-first sm:order-last flex-grow\">\n          <LogoutButton />\n        </div>\n      </div>\n    );\n  }\n  return <LoginButton onLogin={onLogin} />;\n};\n\nexport const Navigation = () => {\n  const [isSearchExpanded, setIsSearchExpanded] = useState(\n    typeof document._searchQuery === \"string\"\n  );\n  const [value, setValue] = useState(document._searchQuery);\n\n  const onChange = (event) => {\n    setValue(event.target.value);\n  };\n\n  // When mobile user clicks to expand search, focus the input\n  const input = useRef(null);\n  useEffect(() => {\n    input.current && input.current.value && input.current.focus();\n  }, [isSearchExpanded]);\n\n  return (\n    <div class=\"flex justify-between items-center align-middle h-12\">\n      <div\n        class={classNames(\n          \"sm:order-2 sm:flex-grow text-center sm:px-10 sm:max-w-4xl\",\n          {\n            \"flex-grow\": isSearchExpanded,\n          }\n        )}\n      >\n        {!isSearchExpanded && (\n          <span\n            onClick={() => {\n              setIsSearchExpanded(true);\n            }}\n            role=\"button\"\n            class=\"sm:hidden block\"\n          >\n            <MagnifyingGlass />\n          </span>\n        )}\n        <div\n          class={classNames(\"sm:flex pr-4 sm:pr-0\", {\n            hidden: !isSearchExpanded,\n          })}\n        >\n          <form\n            class=\"search flex bg-white bg-opacity-25 rounded-md items-center mr-3 px-3 w-full\"\n            method=\"GET\"\n            action=\"/leit\"\n          >\n            <MagnifyingGlass />\n            <input\n              value={value}\n              ref={input}\n              onChange={onChange}\n              name=\"q\"\n              size=\"1\"\n              class=\"bg-transparent flex-grow py-2 px-2 text-sm font-thin overflow-hidden focus:outline-none\"\n              placeholder=\"Leit - t.d. 'Reitir ehf.', 'Brautarholt' eða 'gistiheimili'\"\n            />\n          </form>\n        </div>\n      </div>\n      <div\n        class={classNames(\"flex-grow sm:order-1 sm:flex-grow-0 text-center\", {\n          hidden: isSearchExpanded,\n          \"sm:block\": isSearchExpanded,\n        })}\n      >\n        <a href=\"/s\" class=\"font-black text-lg sm:text-xl\">\n          Planitor\n        </a>\n      </div>\n      <div class=\"order-last text-right\">\n        <User />\n      </div>\n    </div>\n  );\n};\n","import { Fragment, h } from \"preact\";\nimport { useState, useRef, useEffect } from \"preact/hooks\";\nimport { api } from \"./api\";\nimport { TrashFill, BadgePlusRadiowavesRight } from \"./symbols.jsx\";\n\nconst SelectWidget = ({ value, onChange, isDisabled, children }) => {\n  return (\n    <div class=\"inline-block relative text-sm lg:text-base\">\n      <select\n        value={value}\n        onChange={onChange}\n        disabled={isDisabled}\n        class=\"block appearance-none w-full border border-gray-400 hover:border-gray-500 px-1 lg:px-4 py-1 lg:py-2 pr-8 mr-3 rounded shadow leading-tight focus:outline-none focus:shadow-outline\"\n      >\n        {children}\n      </select>\n      <div class=\"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700\">\n        <svg class=\"fill-current h-4 w-4\" viewBox=\"0 0 20 20\">\n          <path d=\"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z\" />\n        </svg>\n      </div>\n    </div>\n  );\n};\n\nconst SubscriptionLoading = () => {\n  return (\n    <div class=\"rounded-lg shadow-sm p-4 w-full bg-white mb-4\">\n      <div class=\"animate-pulse flex flex-row\">\n        <div class=\"bg-gray-400 rounded w-3/4 mr-4 h-8\"></div>\n        <div class=\"bg-gray-400 rounded w-1/4 mr-4 h-8\"></div>\n        <div class=\"bg-gray-400 rounded w-16 h-8\"></div>\n      </div>\n    </div>\n  );\n};\n\nconst Case = ({ serial, id }) => {\n  return <a href={`/cases/${id}`}>{serial}</a>;\n};\n\nconst Search = ({ search_query }) => {\n  return <a href={`/leit?q=${search_query}`}>„{search_query}“</a>;\n};\n\nconst Address = ({ name, hnitnum, radius, onChangeRadius }) => {\n  return <a href={`/hnit/${hnitnum}`}>{name}</a>;\n};\n\nconst Entity = ({ kennitala, name }) => {\n  return <a href={`/f/${kennitala}`}>{name}</a>;\n};\n\nconst Subscription = (props) => {\n  const { subscription } = props;\n\n  const [isLoading, setLoading] = useState(false);\n  const [isDeleted, setDeleted] = useState(false);\n  const [data, setData] = useState(subscription);\n\n  const { id, active, immediate } = data;\n  let value = immediate ? \"immediate\" : \"weekly\";\n\n  if (!active) {\n    value = \"never\";\n  }\n\n  if (isDeleted) return null;\n\n  const onDelete = async (event) => {\n    const isConfirmed = confirm(\n      \"Ertu viss um að þú viljir fjárlægja þennan vaktara?\"\n    );\n    if (!isConfirmed) return;\n    setLoading(true);\n    const data = await api.deleteSubscription(id).then((response) => {\n      return response.data;\n    });\n    setDeleted(true);\n  };\n\n  const onChange = async (event) => {\n    const { value } = event.target;\n    const requestData = {\n      active: value !== \"never\",\n      immediate: value === \"immediate\",\n    };\n    setLoading(true);\n    const responseData = await api\n      .updateSubscription(id, requestData)\n      .then((response) => {\n        return response.data;\n      });\n    setLoading(false);\n    setData(responseData);\n  };\n\n  const onChangeRadius = async (event) => {\n    const { value } = event.target;\n    const responseData = await api\n      .updateSubscription(id, { radius: Number(value) })\n      .then((response) => {\n        return response.data;\n      });\n    setLoading(false);\n    setData(responseData);\n  };\n\n  return (\n    <div class=\"sm:rounded-lg sm:shadow-sm pb-2 sm:p-4 w-full sm:bg-white mb-2 sm:mb-4\">\n      <div class=\"flex flex-col md:flex-row align-middle\">\n        <div class=\"mr-4 flex-grow font-bold sm:text-lg whitespace-no-wrap flex items-center mb-1 sm:mb-0\">\n          {data.case && <Case {...data.case} />}\n          {data.search_query && <Search search_query={data.search_query} />}\n          {data.address && <Address {...data.address} />}\n          {data.entity && <Entity {...data.entity} />}\n        </div>\n        <div>\n          <div class=\"flex justify-end sm:justify-between items-center w-full sm:w-auto\">\n            {data.address && (\n              <div class=\"mr-2 sm:mr-4\">\n                <SelectWidget\n                  value={data.radius || 0}\n                  onChange={onChangeRadius}\n                  isDisabled={isLoading}\n                >\n                  <Fragment>\n                    <option value={0}>0m</option>\n                    <option value={100}>+ 100m</option>\n                    <option value={300}>+ 300m</option>\n                    <option value={500}>+ 500m</option>\n                  </Fragment>\n                </SelectWidget>\n              </div>\n            )}\n            <SelectWidget\n              value={value}\n              onChange={onChange}\n              isDisabled={isLoading}\n            >\n              <Fragment>\n                <option value=\"never\">Afvirkja</option>\n                <option value=\"immediate\">Strax</option>\n                <option value=\"weekly\">Vikuleg</option>\n              </Fragment>\n            </SelectWidget>\n            <button\n              class=\"ml-3 sm:ml-6 text-gray-500 flex-grow sm:flex-grow-0 flex justify-end\"\n              onClick={(event) => {\n                !isLoading && onDelete(event);\n              }}\n            >\n              <TrashFill />\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport const Subscriptions = () => {\n  const [subs, setSubs] = useState([]);\n  useEffect(async () => {\n    const subs = await api.getSubscriptions().then((response) => {\n      return response.data;\n    });\n    setSubs(subs);\n  }, []);\n  if (!subs.length) {\n    return (\n      <div>\n        <SubscriptionLoading />\n        <SubscriptionLoading />\n        <SubscriptionLoading />\n      </div>\n    );\n  }\n  return (\n    <div>\n      {subs.map((sub) => {\n        return <Subscription key={sub.id} subscription={sub} />;\n      })}\n    </div>\n  );\n};\n","import { h, render } from \"preact\";\nimport { useState } from \"preact/hooks\";\nimport classNames from \"classnames\";\n\nimport { api } from \"./api\";\nimport { openModal } from \"./modals\";\n\nconst Button = (props) => {\n  const { loading, onClick, hover, setHover, following, defaultLabel } = props;\n  return (\n    <button\n      class={classNames(\n        \"px-4 py-2 border rounded-lg font-bold sm:inline block mx-auto\",\n        {\n          \"text-gray-500 border-gray-500\": loading,\n          \"bg-midnight text-white\": following && !loading,\n          \"text-midnight\": !following && !loading,\n          \"border-midnight\": !loading,\n        }\n      )}\n      onClick={onClick}\n      onMouseOver={(event) => {\n        setHover(true);\n      }}\n      onMouseOut={(event) => {\n        setHover(false);\n      }}\n    >\n      {(() => {\n        if (hover) {\n          return following ? \"Afvakta\" : defaultLabel || \"Vakta\";\n        } else {\n          return following ? \"Vaktað\" : defaultLabel || \"Vakta\";\n        }\n      })()}\n    </button>\n  );\n};\n\nconst Banner = (props) => {\n  const Link = () => {\n    return (\n      <a class=\"text-midnight underline\" href=\"mailto:hallo@planitor.io\">\n        hallo@planitor.io\n      </a>\n    );\n  };\n  return (\n    <p class=\"text-center\">\n      Vaktarinn stendur öllum til boða gegn mánaðargjaldi. <br />\n      Til að fá aðgang sendu okkur línu á <Link />.\n    </p>\n  );\n};\n\nexport const FollowCase = (props) => {\n  const { id, state, defaultLabel } = props;\n  const [hover, setHover] = useState(false);\n  const [following, setFollowing] = useState(state === \"following\");\n  const [form, setForm] = useState({ isLoading: false, error: null });\n  const onClick = (event) => {\n    event.preventDefault();\n    event.stopPropagation();\n    if (form.isLoading) return;\n    const toggle = () => {\n      setForm({ isLoading: true, error: null });\n      (following ? api.unfollowCase(id) : api.followCase(id))\n        .then((response) => {\n          setFollowing(!following);\n          setHover(false);\n          setForm({ isLoading: false, error: null });\n        })\n        .catch(function (error) {\n          setForm({ isLoading: false, error: error });\n        });\n    };\n    if (document._user === null) {\n      const [el, closeModal] = openModal();\n      render(<Banner />, el);\n    } else {\n      toggle();\n    }\n  };\n  return (\n    <Button\n      loading={form.isLoading}\n      following={following}\n      hover={hover}\n      setHover={setHover}\n      onClick={onClick}\n      defaultLabel={defaultLabel}\n    />\n  );\n};\n\nexport const FollowAddress = (props) => {\n  const { hnitnum, state } = props;\n  const [hover, setHover] = useState(false);\n  const [following, setFollowing] = useState(state === \"following\");\n  const [form, setForm] = useState({ isLoading: false, error: null });\n  const onClick = (event) => {\n    event.preventDefault();\n    event.stopPropagation();\n    if (form.isLoading) return;\n    const toggle = () => {\n      setForm({ isLoading: true, error: null });\n      (following ? api.unfollowAddress(hnitnum) : api.followAddress(hnitnum))\n        .then((response) => {\n          setFollowing(!following);\n          setHover(false);\n          setForm({ isLoading: false, error: null });\n        })\n        .catch(function (error) {\n          setForm({ isLoading: false, error: error });\n        });\n    };\n    if (document._user === null) {\n      const [el, closeModal] = openModal();\n      render(<Banner />, el);\n    } else {\n      toggle();\n    }\n  };\n  return (\n    <Button\n      loading={form.isLoading}\n      following={following}\n      hover={hover}\n      setHover={setHover}\n      onClick={onClick}\n    />\n  );\n};\n","import { h } from \"preact\";\nimport { useState } from \"preact/hooks\";\nimport { api } from \"../api\";\n\nconst saveLocalToken = (token) => localStorage.setItem(\"token\", token);\n\nexport const NewPasswordForm = ({ token }) => {\n  const [form, setForm] = useState({\n    isSuccess: false,\n    isLoading: false,\n    error: null,\n  });\n  const [password, setPassword] = useState(\"\");\n\n  const onChange = (event) => {\n    setPassword(event.target.value);\n  };\n\n  const onSubmit = (event) => {\n    event.preventDefault();\n    setForm({ isLoading: true, isSuccess: false, error: null });\n    api\n      .resetPassword(password, token)\n      .then((response) => {\n        saveLocalToken(response.data.access_token);\n        setForm({ isLoading: false, error: null, isSuccess: true });\n      })\n      .catch(function (error) {\n        // remove dirty, meant for highlighting invalid fields until user edits\n        let errorMessage =\n          error.response.data.detail || \"Óþekkt villa á vefþjóni\";\n        setForm({ isLoading: false, isSuccess: false, error: errorMessage });\n      });\n  };\n\n  return (\n    <div>\n      <h1 class=\"text-center text-2xl\">Nýtt lykilorð</h1>\n      <div class=\"py-2 my-2\"></div>\n      <form onSubmit={onSubmit}>\n        {form.error && (\n          <div class=\"mb-4 text-red-700 font-bold\">{form.error}</div>\n        )}\n        {form.isSuccess && (\n          <div class=\"mb-4 text-green-600 font-bold\">\n            Lykilorðið hefur verið uppfært.\n          </div>\n        )}\n        <div class=\"mb-4\">\n          <input\n            class=\"shadow appearance-none border rounded w-full py-2 px-3\"\n            name=\"password\"\n            type=\"password\"\n            disabled={form.isLoading || form.isSuccess}\n            value={password.value}\n            onInput={onChange}\n          />\n        </div>\n        <div class=\"block md:flex items-center justify-between\">\n          <div>\n            <button\n              class=\"btn-primary\"\n              type=\"submit\"\n              disabled={form.isLoading || form.isSuccess}\n            >\n              Vista\n            </button>\n          </div>\n        </div>\n      </form>\n    </div>\n  );\n};\n","import { h } from \"preact\";\nimport { api } from \"./api\";\n\nexport let mapkit = window[\"mapkit\"];\n\n// Render map only when it is in the viewport\ndocument.addEventListener(\"lazybeforeunveil\", function (e) {\n  let el = e.target;\n  if (el.classList.contains(\"map\")) {\n    var address = new mapkit.Coordinate(\n      parseFloat(el.dataset.lat),\n      parseFloat(el.dataset.lon)\n    );\n    var region = new mapkit.CoordinateRegion(\n      address,\n      new mapkit.CoordinateSpan(0.03, 0.04)\n    );\n    var map = new mapkit.Map(el);\n\n    var addressAnnotation = new mapkit.MarkerAnnotation(address, {\n      color: \"#f4a56d\",\n      title: el.dataset.address,\n    });\n    map.showItems([addressAnnotation]);\n\n    map.region = region;\n  }\n});\n\nexport async function getEntityMapOptions(kennitala) {\n  const addresses = await api.getEntityAddresses(kennitala).then((response) => {\n    return response.data.addresses;\n  });\n  if (addresses.length === 0) return null;\n\n  var north = addresses[0].lat,\n    south = north,\n    west = addresses[0].lon,\n    east = west,\n    pins = [];\n\n  // Shift direction variables to the outermost parts of pins to create a boundary region\n  for (var address of addresses) {\n    const { lat, lon, label, status } = address;\n    const [_, __, labelColor] = status;\n    pins.push(\n      new mapkit.MarkerAnnotation(new mapkit.Coordinate(lat, lon), {\n        title: label,\n        color:\n          { green: \"#48BB78\", yellow: \"#F6E05E\", red: \"#E53E3E\" }[labelColor] ||\n          \"#718096\",\n      })\n    );\n    if (lat > north) north = lat;\n    if (lat < south) south = lat;\n    if (lon < west) west = lon;\n    if (lon > east) east = lon;\n  }\n\n  if (addresses.length === 1) {\n    return {\n      annotations: pins,\n      region: new mapkit.CoordinateRegion(\n        new mapkit.Coordinate(north, west),\n        new mapkit.CoordinateSpan(0.01, 0.01)\n      ),\n    };\n  } else {\n    const latDiff = Math.abs(north - south) * 0.1;\n    const lonDiff = Math.abs(east - west) * 0.1;\n    const region = new mapkit.BoundingRegion(\n      north + latDiff,\n      east + lonDiff,\n      south - latDiff,\n      west - lonDiff\n    ).toCoordinateRegion();\n    return {\n      annotations: pins,\n      region: region,\n    };\n  }\n}\n","import { h, render } from \"preact\";\n\nimport { Navigation } from \"./navigation.jsx\";\nimport { Subscriptions } from \"./subscriptions.jsx\";\nimport { FollowCase, FollowAddress } from \"./follow.jsx\";\nimport { NewPasswordForm } from \"./forms/new-password.jsx\";\nimport { openModal } from \"./modals.js\";\nimport { mapkit, getEntityMapOptions } from \"./maps.jsx\";\n\nmapkit.init({\n  authorizationCallback: (done) => {\n    fetch(\"/mapkit-token\")\n      .then((res) => res.text())\n      .then((token) => done(token))\n      .catch((error) => {\n        console.error(error);\n      });\n  },\n});\n\nconst passwordRecoveryEl = document.getElementById(\"password-recovery\");\nif (passwordRecoveryEl) {\n  const [el, closeModal] = openModal();\n  render(<NewPasswordForm token={passwordRecoveryEl.dataset.token} />, el);\n}\n\nconst navigationEl = document.getElementById(\"navigation\");\nif (navigationEl) {\n  render(<Navigation />, navigationEl);\n}\n\nconst subscriptionsEl = document.getElementById(\"subscriptions\");\nif (subscriptionsEl) {\n  render(<Subscriptions />, subscriptionsEl);\n}\n\nmapkit.addEventListener(\"configuration-change\", function (event) {\n  if (event.status === \"Initialized\") {\n    [...document.querySelectorAll(\".entity-map\")].forEach(async (el) => {\n      const options = await getEntityMapOptions(el.dataset.kennitala);\n      if (options) new mapkit.Map(el, options);\n    });\n  }\n});\n\n[...document.querySelectorAll(\".follow-case\")].forEach((button) => {\n  const defaultLabel = button.innerText;\n  button.innerHTML = \"\";\n  render(\n    <FollowCase\n      id={button.dataset.id}\n      state={button.dataset.state}\n      defaultLabel={defaultLabel}\n    />,\n    button\n  );\n});\n\n[...document.querySelectorAll(\".follow-address\")].forEach((button) => {\n  render(\n    <FollowAddress\n      hnitnum={button.dataset.hnitnum}\n      state={button.dataset.state}\n    />,\n    button\n  );\n});\n"],"names":["authHeaders","headers","Authorization","localStorage","getItem","api","logInGetToken","email","password","params","URLSearchParams","append","axios","post","getMe","get","passwordRecovery","resetPassword","token","new_password","logout","followCase","id","unfollowCase","delete","followAddress","hnitnum","unfollowAddress","getEntityAddresses","kennitala","getSubscriptions","updateSubscription","data","deleteSubscription","classNames","classArr","filter","el","join","LoginForm","props","onSuccess","setScreen","username","setUsername","useState","value","isDirty","errors","setPassword","form","setForm","isLoading","error","h","class","onSubmit","event","preventDefault","then","response","setItem","access_token","catch","forEach","setState","prevState","detail","formError","Array","isArray","loc","msg","type","msgTranslation","undefined","fieldName","length","for","name","disabled","onInput","target","map","onClick","stopPropagation","PasswordRecoveryForm","emailDefaultValue","isSuccess","setEmail","errorMessage","Login","screen","login","openModal","modalEl","document","getElementById","classList","remove","cleanup","add","window","addEventListener","closest","querySelectorAll","querySelector","MagnifyingGlass","width","height","viewBox","transform","d","PersonFill","TrashFill","LogoutButton","removeItem","location","reload","href","role","LoginButton","onLogin","closeModal","render","User","user","setUser","_user","style","console","log","Navigation","isSearchExpanded","setIsSearchExpanded","_searchQuery","setValue","input","useRef","useEffect","current","focus","hidden","method","action","ref","onChange","size","placeholder","SelectWidget","isDisabled","children","SubscriptionLoading","Case","serial","Search","search_query","Address","radius","onChangeRadius","Entity","Subscription","subscription","setLoading","isDeleted","setDeleted","setData","active","immediate","case","address","entity","async","responseData","Number","Fragment","requestData","confirm","onDelete","Subscriptions","subs","setSubs","sub","key","Button","loading","hover","setHover","following","defaultLabel","onMouseOver","onMouseOut","Banner","FollowCase","state","setFollowing","FollowAddress","NewPasswordForm","saveLocalToken","mapkit","e","contains","Coordinate","parseFloat","dataset","lat","lon","region","CoordinateRegion","CoordinateSpan","Map","addressAnnotation","MarkerAnnotation","color","title","showItems","init","authorizationCallback","done","fetch","res","text","passwordRecoveryEl","navigationEl","subscriptionsEl","status","options","addresses","north","south","west","east","pins","label","_","__","labelColor","push","green","yellow","red","annotations","latDiff","Math","abs","lonDiff","BoundingRegion","toCoordinateRegion","getEntityMapOptions","button","innerText","innerHTML"],"mappings":"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"}